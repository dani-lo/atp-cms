<h2>Users Operations</h2>
<p>This is the atp cms for users management.</p>
<div ng-controller="UsersCtrl" ng-cloak> 
        <div style="width: 600px;"> 
            <table class="table table-striped table-bordered table-condensed table-hover"> 
                <tr> 
                    <th style="width: 100px;"> 
                        <div class="btn-toolbar"><button ng-click="toggleAddMode()">Toggle Add</button></div> 
                    </th> 
                    <th style="width: 50px;">Id</th> 
                    <th>Email</th> 
                </tr> 
                <tr ng-show="addMode"  class="user-add-row"> 
                    <td> 
                        <div class="btn-toolbar"> 
                            <div class="btn-group"> 
                                <button ng-click="addUser()">Add</button> 
                                <!--<button ng-click="toggleAddMode()">Cancel</button>-->
                            </div> 
                        </div> 
                    </td> 
                    <td></td> 
                    <td> 
                        <div class="user-data-ui">
                            <div ng-repeat="advertiserObj in advertisers">
                                <input ng-model="user.email" /> 
                                <p  class="advertiser-title"><!--<input type="checkbox" />-->{{advertiserObj.advertiser.advertiserName}}</p>
                                <div class="advertiser-permissions">
                                    <span  ng-repeat="market in advertiserObj.markets" class="nested"><input type="checkbox" />{{market.marketName}}</span>
                                </div>
                            </div>
                            <!--
                            <label ng-repeat="advertiser in advertisers">
                                <input type="checkbox" ng-model="user.permissions.advertiser"  ng-click="advertiserClick(this)"> {{advertiser.advertiser.advertiserName}}
                                <div ng-show="currAdvertisers[advertiser.advertiser.advertiserID].indexOf('::' + advertiser.advertiser.advertiserID) !== -1">
                                    <label ng-repeat="market in advertiser.markets">
                                        <input type="checkbox" checklist-model="user.permissions[advertiser.advertiser.advertiserID]" checklist-value="market.marketID"> {{market.marketName}}
                                    </label>
                                </div>

                            </label>
                        -->
                        </div>
                    </td> 
                </tr> 
                <tr class="user-edit-row" ng-repeat="user in users | orderBy:'id':true"> 
                    <td> 
                        <div class="btn-toolbar" ng-show="user.editMode == null || user.editMode == false"> 
                            <div class="btn-group"> 
                                <button ng-click="toggleEditMode(user)">Edit</button> 
                                <button ng-click="deleteUser(user)">Delete</button> 
                            </div> 
                        </div> 
                        <div class="btn-toolbar" ng-show="user.editMode == true"> 
                            <div class="btn-group"> 
                                <button ng-click="toggleEditMode(user)">Cancel</i> 
                                <button ng-click="updateUser(user)">Update</i> 
                                
                            </div> 
                        </div> 
                    </td> 
                    <td>{{user.id}}</td> 
                    <td> 

                        <p ng-show="user.editMode == null || user.editMode == false">{{user.email}}</p> 
                        <p><input ng-model="useredit[user.id].email" ng-show="user.editMode == true" /> </p>
                        
                        <div class="user-edit-row" ng-repeat="advertiserObj in advertisers">
                            
                            <p class="advertiser-title">{{advertiserObj.advertiser.advertiserName}}</span>
                            <div class="advertiser-permissions">
                                <span ng-class="{editable: user.editMode == true, activespan : userHasMarket(user, market.marketID)}" ng-repeat="market in advertiserObj.markets" class="nested">
                                    <input type="checkbox" ng-checked="userHasMarket(user, market.marketID)" ng-model="useredit[user.id].permissions[advertiserObj.advertiser.advertiserID][market.marketID]" />{{market.marketName}}
                                </span>
                            </div>
                        </div>
                        <!--
                        <label ng-repeat="advertiser in advertisers">
                            <input type="checkbox" ng-model="user.permissions.advertiser"  ng-click="advertiserClick(this)"> {{advertiser.advertiser.advertiserName}}
                            <label ng-repeat="market in advertiser.markets" ng-show="currAdvertisers.indexOf('::' + advertiser.advertiser.advertiserID) !== -1">
                                <input type="checkbox" checklist-model="user.permissions[advertiser.advertiser.advertiserID]" checklist-value="market.marketID"> {{market.marketName}}
                            </label>


                        </label>
                        -->
                    </td> 
                </tr> 
            </table> 
        </div> 
    </div> 